# ================================================================
# BikeDreams Backend - Production Environment Configuration
# ================================================================
#
# This file contains environment variables for AWS EC2 production deployment.
# Copy this file to .env.production and update with your actual values.
#
# IMPORTANT: Never commit .env.production to version control!
#
# ================================================================

# ----------------------------------------------------------------
# Application Configuration
# ----------------------------------------------------------------
NODE_ENV=production
PORT=3001
API_VERSION=v1
APP_NAME=BikeDreams Backend

# Base URL (use your EC2 public IP)
# Example: http://54.123.45.67:3001
BASE_URL=http://YOUR_EC2_PUBLIC_IP:3001

# CORS Configuration
# Add your frontend URL here (can be another EC2 IP or domain)
CORS_ORIGIN=http://YOUR_FRONTEND_URL
CORS_CREDENTIALS=true

# ----------------------------------------------------------------
# Database Configuration (PostgreSQL)
# ----------------------------------------------------------------

# For Docker-based PostgreSQL (recommended for single EC2 instance)
DATABASE_URL=postgresql://bikedreams_user:CHANGE_THIS_SECURE_PASSWORD@postgres:5432/bikedreams

# PostgreSQL Container Configuration
POSTGRES_USER=bikedreams_user
POSTGRES_PASSWORD=CHANGE_THIS_SECURE_PASSWORD
POSTGRES_DB=bikedreams
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# For AWS RDS (if using managed database)
# DATABASE_URL=postgresql://username:password@your-rds-endpoint.region.rds.amazonaws.com:5432/bikedreams
# POSTGRES_HOST=your-rds-endpoint.region.rds.amazonaws.com

# Database Pool Configuration
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_TIMEOUT=30000

# ----------------------------------------------------------------
# Redis Configuration
# ----------------------------------------------------------------

# For Docker-based Redis (recommended for single EC2 instance)
REDIS_URL=redis://redis:6379
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_THIS_REDIS_PASSWORD

# For AWS ElastiCache (if using managed Redis)
# REDIS_URL=redis://your-elasticache-endpoint.cache.amazonaws.com:6379
# REDIS_HOST=your-elasticache-endpoint.cache.amazonaws.com

# Redis Configuration
REDIS_DB=0
REDIS_TTL=3600
REDIS_MAX_RETRIES=3

# ----------------------------------------------------------------
# Security & Authentication
# ----------------------------------------------------------------

# JWT Secrets (MUST CHANGE - generate with: openssl rand -base64 64)
JWT_SECRET=CHANGE_THIS_TO_A_VERY_LONG_RANDOM_STRING_AT_LEAST_64_CHARACTERS_LONG
JWT_REFRESH_SECRET=CHANGE_THIS_TO_ANOTHER_VERY_LONG_RANDOM_STRING_DIFFERENT_FROM_JWT_SECRET

# JWT Configuration
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d
JWT_ALGORITHM=HS256

# Encryption Key (generate with: openssl rand -hex 32)
ENCRYPTION_KEY=CHANGE_THIS_TO_A_32_CHARACTER_HEX_STRING

# Session Configuration
SESSION_SECRET=CHANGE_THIS_SESSION_SECRET_TO_RANDOM_STRING
SESSION_MAX_AGE=86400000

# Password Hashing
BCRYPT_ROUNDS=12

# ----------------------------------------------------------------
# Rate Limiting & Security
# ----------------------------------------------------------------

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# Security Headers
HELMET_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# Content Security Policy
CSP_ENABLED=true
CSP_DIRECTIVES=default-src 'self'

# ----------------------------------------------------------------
# Logging & Monitoring
# ----------------------------------------------------------------

# Logging
LOG_LEVEL=info
LOG_FORMAT=json
LOG_DIR=./logs
LOG_MAX_SIZE=10m
LOG_MAX_FILES=14

# Enable specific log types
LOG_HTTP_REQUESTS=true
LOG_DATABASE_QUERIES=false
LOG_ERRORS=true
LOG_SECURITY_EVENTS=true

# Monitoring
ENABLE_METRICS=true
METRICS_PORT=9090

# Health Check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_TOKEN=CHANGE_THIS_HEALTH_CHECK_TOKEN

# ----------------------------------------------------------------
# Email Configuration (Optional)
# ----------------------------------------------------------------

# SMTP Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password

# Email From
EMAIL_FROM=noreply@bikedreams.com
EMAIL_FROM_NAME=BikeDreams

# ----------------------------------------------------------------
# File Upload & Storage
# ----------------------------------------------------------------

# Upload Configuration
UPLOAD_MAX_FILE_SIZE=5242880
UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/webp
UPLOAD_DIR=./uploads

# AWS S3 (if using S3 for file storage)
# AWS_REGION=us-east-1
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# AWS_S3_BUCKET=bikedreams-uploads

# ----------------------------------------------------------------
# External Services & APIs
# ----------------------------------------------------------------

# Payment Gateway (if applicable)
# STRIPE_SECRET_KEY=sk_live_...
# STRIPE_PUBLISHABLE_KEY=pk_live_...
# STRIPE_WEBHOOK_SECRET=whsec_...

# Analytics (if applicable)
# GOOGLE_ANALYTICS_ID=UA-XXXXXXXXX-X

# ----------------------------------------------------------------
# Feature Flags
# ----------------------------------------------------------------

# Enable/Disable Features
ENABLE_SWAGGER=false
ENABLE_CORS=true
ENABLE_COMPRESSION=true
ENABLE_HELMET=true
ENABLE_RATE_LIMITING=true

# ----------------------------------------------------------------
# Backup & Maintenance
# ----------------------------------------------------------------

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=7
BACKUP_DIR=./backups

# Maintenance Mode
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=System is under maintenance. Please try again later.

# ----------------------------------------------------------------
# Development & Debug (DISABLE IN PRODUCTION)
# ----------------------------------------------------------------

# Debug Mode (MUST BE FALSE IN PRODUCTION)
DEBUG=false
DEBUG_SQL=false
DEBUG_REDIS=false

# Prisma
PRISMA_HIDE_UPDATE_MESSAGE=true

# ----------------------------------------------------------------
# Docker & Container Configuration
# ----------------------------------------------------------------

# Container Names
CONTAINER_PREFIX=bikedreams

# Network
DOCKER_NETWORK=bikedreams-network

# ----------------------------------------------------------------
# Timezone & Localization
# ----------------------------------------------------------------

TZ=America/Bogota
LOCALE=es-CO
DEFAULT_LANGUAGE=es

# ----------------------------------------------------------------
# Performance & Optimization
# ----------------------------------------------------------------

# Node.js Performance
NODE_OPTIONS=--max-old-space-size=2048

# Compression
COMPRESSION_LEVEL=6
COMPRESSION_THRESHOLD=1024

# Cache
CACHE_TTL=3600
CACHE_MAX_SIZE=100

# ================================================================
# IMPORTANT SECURITY NOTES:
# ================================================================
#
# 1. Change ALL passwords and secrets before deploying
# 2. Use strong, randomly generated values for all secrets
# 3. Never commit this file to version control
# 4. Restrict file permissions: chmod 600 .env.production
# 5. Regularly rotate secrets and passwords
# 6. Use AWS Secrets Manager for sensitive data (optional)
#
# Generate secure random strings:
#   - JWT Secret: openssl rand -base64 64
#   - Encryption Key: openssl rand -hex 32
#   - Passwords: openssl rand -base64 32
#
# ================================================================
